<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcmaes: libcmaes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcmaes
   &#160;<span id="projectnumber">0.10</span>
   </div>
   <div id="projectbrief">A C++11 library for stochastic optimization with CMA-ES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">libcmaes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://beniz.github.io/libcmaes/doc/html/index.html"><img src="https://img.shields.io/badge/Documentation-Doxygen-success" alt="Doxygen" class="inline"/></a></p>
<p>libcmaes is a multithreaded C++11 implementation (with Python bindings) of algorithms of the CMA-ES family for optimization of nonlinear non-convex 'blackbox' functions. The implemented algorithms have a wide range of applications in various disciplines, ranging from pure function minimization, optimization in industrial and scientific applications, to the solving of reinforcement and machine learning problems.</p>
<p>Over the past decade, both the original CMA-ES and its improved flavors have proven very effective in optimizing functions when no gradient is available. Typically, the algorithm does find the minimum value of an objective function in a minimal number of function calls, compared to other methods. For a full report of recent results, see (3).</p>
<p>CMA-ES is mostly the work of Nikolaus Hansen (4) and a few others (8). Other implementations can be found in (5).</p>
<p>Main functionalities: At the moment, the library implements many of the most effective CMA-ES algorihms, and defaults to the 'vanilla' version (1). Current features include:</p>
<ul>
<li>high-level API for simple use in external applications;</li>
<li>implements several flavors of CMA-ES, IPOP-CMA-ES, BIPOP-CMA-ES, active CMA-ES, active IPOP and BIPOP restart strategies, sep-CMA-ES and VD-CMA (both with linear time &amp; space complexity), IPOP/BIPOP sep and VD-CMA;</li>
<li>high performances, the fastest implementation (9), some operations benefit from multicores;</li>
<li>some algorithms can scale up to millions of dimensions;</li>
<li>support for objective function gradient, when available;</li>
<li>support for <a href="https://en.wikipedia.org/wiki/Surrogate_model">surrogate models</a>(10);</li>
<li>support for elitism and uncertainty handling;</li>
<li>support for profile likelihood and contour of objective functions;</li>
<li>a control exe in the command line for running the algorithm over a range of classical single-objective optimization problems;</li>
<li>Python bindings along with high-level easy-to-use interface.</li>
</ul>
<p>Documentation:</p>
<ul>
<li>Full documentation is available from <a href="https://github.com/beniz/libcmaes/wiki">https://github.com/beniz/libcmaes/wiki</a></li>
<li>API documentation is available from <a href="http://beniz.github.io/libcmaes/doc/html/index.html">http://beniz.github.io/libcmaes/doc/html/index.html</a></li>
</ul>
<p>Dependencies:</p>
<ul>
<li><a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">eigen</a> for all matrix operations;</li>
<li><a href="https://code.google.com/p/google-glog/">glog</a> for logging events and debug (optional);</li>
<li><a href="https://code.google.com/p/gflags/">gflags</a> for command line parsing (optional);</li>
<li><a href="https://code.google.com/p/googletest/">gtest</a> for unit testing (optional);</li>
<li><a href="http://www.boost.org/doc/libs/1_56_0/libs/python/doc/">libboost-python</a> for Python bindings (optional);</li>
<li><a href="http://www.numpy.org/">numpy</a> for Python bindings (optional).</li>
</ul>
<p>Implementation: The library makes use of C++ policy design for modularity, performance and putting the maximum burden on the checks at compile time. The implementation closely follows the algorithms described in (2), (6) and few other publications.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Authors</h2>
<p>libcmaes was designed and implemented by Emmanuel Benazera with help of Nikolaus Hansen and contributors, on behalf of Inria Saclay / Research group TAO and Laboratoire de l'Accélérateur linéaire, research group Appstats.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Build</h2>
<p>Below are instruction for Linux systems, for building on Mac OSX, see <a href="https://github.com/beniz/libcmaes/wiki/Building-libcmaes-on-Mac-OSX">https://github.com/beniz/libcmaes/wiki/Building-libcmaes-on-Mac-OSX</a></p>
<p>Beware of dependencies, typically on Debian/Ubuntu Linux, do:</p>
<div class="fragment"><div class="line">sudo apt-get install autoconf automake libtool libgoogle-glog-dev libgflags-dev libeigen3-dev</div>
</div><!-- fragment --><p>For compiling with basic options enabled: </p><div class="fragment"><div class="line">./autogen.sh</div>
<div class="line">echo &quot;#define CMAES_EXPORT&quot; &gt; include/libcmaes/cmaes_export.h</div>
<div class="line">./configure</div>
<div class="line">make</div>
</div><!-- fragment --><p>For compiling with CMake: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake .. -DCMAKE_INSTALL_PREFIX=~/.local/ -DLIBCMAES_BUILD_TESTS=ON</div>
<div class="line">make -j2</div>
<div class="line">make install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md3"></a>
Run examples</h2>
<div class="fragment"><div class="line">cd tests</div>
<div class="line">./test_functions --dim 30 --lambda 100 --max_iter 120 --fname fsphere</div>
</div><!-- fragment --><p>to minimize the sphere function in 30D with 100 offsprings per generation, </p><div class="fragment"><div class="line">./test_functions --dim 20 --lambda 100 --max_iter 1000 --fname rosenbrock</div>
</div><!-- fragment --><p>to minimize the Rosenbrock function in 20D with 100 offsprings. To see available function, do </p><div class="fragment"><div class="line">./test_functions --list</div>
</div><!-- fragment --><p>to plot results, use a file output and then the included Gnuplot script </p><div class="fragment"><div class="line">./test_functions --fname rastrigin --dim 10 --lambda 200 --max_iter 130 --fplot out.dat -sigma0 5 -x0 5 -seed 5489</div>
<div class="line">gnuplot -e &quot;filename=&#39;out.dat&#39;&quot; cma_multiplt.dem</div>
</div><!-- fragment --><p>to plot results with matplotlib instead </p><div class="fragment"><div class="line">python ../python/cma_multiplt.py out.dat</div>
</div><!-- fragment --><p>to run a check across a range of classical single-objective optimization functions: </p><div class="fragment"><div class="line">./test_functions --all</div>
</div><!-- fragment --><p>for help, do </p><div class="fragment"><div class="line">./test_functions --help</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Sample code</h2>
<div class="fragment"><div class="line"> {C++}</div>
<div class="line">#include &quot;cmaes.h&quot;</div>
<div class="line">#include &lt;iostream&gt;</div>
<div class="line"> </div>
<div class="line">using namespace libcmaes;</div>
<div class="line"> </div>
<div class="line">FitFunc fsphere = [](const double *x, const int N)</div>
<div class="line">{</div>
<div class="line">  double val = 0.0;</div>
<div class="line">  for (int i=0;i&lt;N;i++)</div>
<div class="line">    val += x[i]*x[i];</div>
<div class="line">  return val;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">int main(int argc, char *argv[])</div>
<div class="line">{</div>
<div class="line">  int dim = 10; // problem dimensions.</div>
<div class="line">  std::vector&lt;double&gt; x0(dim,10.0);</div>
<div class="line">  double sigma = 0.1;</div>
<div class="line">  //int lambda = 100; // offsprings at each generation.</div>
<div class="line">  CMAParameters&lt;&gt; cmaparams(x0,sigma);</div>
<div class="line">  //cmaparams.set_algo(BIPOP_CMAES);</div>
<div class="line">  CMASolutions cmasols = cmaes&lt;&gt;(fsphere,cmaparams);</div>
<div class="line">  std::cout &lt;&lt; &quot;best solution: &quot; &lt;&lt; cmasols &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; &quot;optimization took &quot; &lt;&lt; cmasols.elapsed_time() / 1000.0 &lt;&lt; &quot; seconds\n&quot;;</div>
<div class="line">  return cmasols.run_status();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Python bindings</h2>
<p>To build the Python bindings and use libcmaes from Python code, see instructions below, and for more details, see <a href="https://github.com/beniz/libcmaes/wiki/Python-bindings">https://github.com/beniz/libcmaes/wiki/Python-bindings</a></p><ul>
<li>install 'boost-python', on Debian/Ubuntu systems: <div class="fragment"><div class="line">sudo apt-get install libboost-python-dev</div>
</div><!-- fragment --></li>
<li>build the libcmaes with support for Python bindings: <div class="fragment"><div class="line">./autogen.sh</div>
<div class="line">./configure --enable-python --prefix=/home/yourusername</div>
<div class="line">make</div>
<div class="line">make install</div>
</div><!-- fragment --></li>
</ul>
<p>and with <code>cmake</code>: </p><div class="fragment"><div class="line">cmake .. -DCMAKE_INSTALL_PREFIX=~/.local/ -DLIBCMAES_BUILD_PYTHON=ON</div>
</div><!-- fragment --><ul>
<li>test the bindings: <div class="fragment"><div class="line">cd python</div>
<div class="line">export LD_LIBRARY_PATH=/home/yourusername/lib</div>
<div class="line">python ptest.py</div>
</div><!-- fragment --></li>
</ul>
<p>Sample python code: </p><div class="fragment"><div class="line">import lcmaes</div>
<div class="line"> </div>
<div class="line"># input parameters for a 10-D problem</div>
<div class="line">x = [10]*10</div>
<div class="line">olambda = 10 # lambda is a reserved keyword in python, using olambda instead.</div>
<div class="line">seed = 0 # 0 for seed auto-generated within the lib.</div>
<div class="line">sigma = 0.1</div>
<div class="line">p = lcmaes.make_simple_parameters(x,sigma,olambda,seed)</div>
<div class="line"> </div>
<div class="line"># objective function.</div>
<div class="line">def nfitfunc(x,n):</div>
<div class="line">    val = 0.0</div>
<div class="line">    for i in range(0,n):</div>
<div class="line">        val += x[i]*x[i]</div>
<div class="line">    return val</div>
<div class="line"> </div>
<div class="line"># generate a function object</div>
<div class="line">objfunc = lcmaes.fitfunc_pbf.from_callable(nfitfunc);</div>
<div class="line"> </div>
<div class="line"># pass the function and parameter to cmaes, run optimization and collect solution object.</div>
<div class="line">cmasols = lcmaes.pcmaes(objfunc,p)</div>
<div class="line"> </div>
<div class="line"># collect and inspect results</div>
<div class="line">bcand = cmasols.best_candidate()</div>
<div class="line">bx = lcmaes.get_candidate_x(bcand)</div>
<div class="line">print &quot;best x=&quot;,bx</div>
<div class="line">print &quot;distribution mean=&quot;,lcmaes.get_solution_xmean(cmasols)</div>
<div class="line">cov = lcmaes.get_solution_cov(cmasols) # numpy array</div>
<div class="line">print &quot;cov=&quot;,cov</div>
<div class="line">print &quot;elapsed time=&quot;,cmasols.elapsed_time(),&quot;ms&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Practical hints</h2>
<p>CMA-ES requires two components from the user:</p><ul>
<li>the initial start point x0;</li>
<li>the initial value for sigma, the so-called step-size or error guess.</li>
</ul>
<p>In short: the optimum that is looked after should better not be far away from the interval [x0 - sigma0, x0 + sigma0] in each dimension, where distance is defined by sigma0.</p>
<p>See <a href="https://github.com/beniz/libcmaes/wiki/Practical-hints">https://github.com/beniz/libcmaes/wiki/Practical-hints</a> and <a href="https://www.lri.fr/~hansen/cmaes_inmatlab.html#practical">https://www.lri.fr/~hansen/cmaes_inmatlab.html#practical</a> for more detailed useful advices using CMA-ES.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Run BBOB 2013 Black-Box Optimization Benchmark</h2>
<p>There's an install script in the repository. Do: </p><div class="fragment"><div class="line">cd tests</div>
<div class="line">./bbobsetup.sh</div>
</div><!-- fragment --><p>you can now benchmark any of the implemented flavors of CMA-ES (beware, this make take a while, ~hours): </p><div class="fragment"><div class="line">./bbobexperiment -alg bipop</div>
</div><!-- fragment --><p>for the command above, results will be in repository bipop_bbob See (7) for more information and details.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
References</h2>
<ul>
<li>(1) Hansen, N. and A. Ostermeier (2001). Completely Derandomized Self-Adaptation in Evolution Strategies. Evolutionary Computation, 9(2), pp. 159-195.</li>
<li>(2) Hansen, N. (2009). Benchmarking a BI-Population CMA-ES on the BBOB-2009 Function Testbed. Workshop Proceedings of the GECCO Genetic and Evolutionary Computation Conference, ACM, pp. 2389-2395. <a href="http://hal.archives-ouvertes.fr/inria-00382093/en">http://hal.archives-ouvertes.fr/inria-00382093/en</a></li>
<li>(3) N. Hansen, A. Auger, R. Ros, S. Finck, P. Posik: Comparing Results of 31 Algorithms from the Black-Box Optimization Benchmarking BBOB-2009. Workshop Proceedings of the GECCO Genetic and Evolutionary Computation Conference 2010, ACM. <a href="http://www.lri.fr/~hansen/ws1p34.pdf">http://www.lri.fr/~hansen/ws1p34.pdf</a></li>
<li>(4) <a href="https://www.lri.fr/~hansen/">https://www.lri.fr/~hansen/</a></li>
<li>(5) <a href="https://www.lri.fr/~hansen/cmaes_inmatlab.html">https://www.lri.fr/~hansen/cmaes_inmatlab.html</a></li>
<li>(6) Hansen, N., R. Ros (2010). Benchmarking a Weighted Negative Covariance Matrix Update on the BBOB-2010 Noiseless Testbed. Workshop Proceedings of the GECCO Genetic and Evolutionary Computation Conference 2010, ACM, pp. 1673-1680, <a href="https://www.lri.fr/~hansen/ws1p32-hansen.pdf">https://www.lri.fr/~hansen/ws1p32-hansen.pdf</a></li>
<li>(7) <a href="http://coco.gforge.inria.fr/doku.php?id=bbob-2013">http://coco.gforge.inria.fr/doku.php?id=bbob-2013</a></li>
<li>(8) Y. Akimoto, A. Auger and N. Hansen (2014). Comparison-Based Natural Gradient Optimization in High Dimension. In Proceedings of Genetic and Evolutionary Computation Conference 2014</li>
<li>(9) <a href="https://github.com/beniz/libcmaes/issues/82">https://github.com/beniz/libcmaes/issues/82</a></li>
<li>(10) Loshchilov I. (2013) Surrogate-Assisted Evolutionary Algorithms, PhD-Thesis, University Paris-Sud, <a href="https://www.lri.fr/~ilya/phd.html">https://www.lri.fr/~ilya/phd.html</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
Funding</h2>
<p>This work was supported by the ANR-2010-COSI-002 grant of the French NationalA Research Agency. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
